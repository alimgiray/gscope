{{define "project_settings"}}
{{template "header" .}}

<div class="card">
    <div class="card-header">Project Settings - {{.Project.Name}}</div>
    
    <!-- Project Name Form -->
    <div class="mb-4">
        <h4 class="text-green-400 mb-2">Project Name</h4>
        <form method="POST" action="/projects/{{.Project.ID}}/settings/name" class="flex gap-2">
            <input type="text" name="name" value="{{.Project.Name}}" class="form-control flex-1" required>
            <button type="submit" class="btn btn-primary">Update Name</button>
        </form>
    </div>

    <!-- Score Settings Form -->
    <div class="mb-4">
        <h4 class="text-green-400 mb-2">Score Settings</h4>
        <form method="POST" action="/projects/{{.Project.ID}}/settings/scores">
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-xs">Additions</label>
                    <input type="number" name="additions" value="{{.ScoreSettings.Additions}}" min="0" class="form-control" required>
                </div>
                <div>
                    <label class="text-xs">Deletions</label>
                    <input type="number" name="deletions" value="{{.ScoreSettings.Deletions}}" min="0" class="form-control" required>
                </div>
                <div>
                    <label class="text-xs">Commits</label>
                    <input type="number" name="commits" value="{{.ScoreSettings.Commits}}" min="0" class="form-control" required>
                </div>
                <div>
                    <label class="text-xs">Pull Requests</label>
                    <input type="number" name="pull_requests" value="{{.ScoreSettings.PullRequests}}" min="0" class="form-control" required>
                </div>
                <div>
                    <label class="text-xs">Comments</label>
                    <input type="number" name="comments" value="{{.ScoreSettings.Comments}}" min="0" class="form-control" required>
                </div>
            </div>
            <button type="submit" class="btn btn-primary mt-2">Update Scores</button>
        </form>
    </div>

    <!-- Excluded Extensions -->
    <div class="mb-4">
        <h4 class="text-green-400 mb-2">Excluded Extensions</h4>
        
        <!-- Add Extension Form -->
        <form method="POST" action="/projects/{{.Project.ID}}/settings/extensions" class="flex gap-2 mb-2">
            <input type="text" name="extension" placeholder="e.g., exe, dll, min.js" class="form-control flex-1" required>
            <button type="submit" class="btn btn-primary">Add Extension</button>
        </form>

        <!-- Current Extensions -->
        {{if .ExcludedExtensions}}
        <div class="text-xs">
            {{range .ExcludedExtensions}}
            <div class="flex justify-between items-center mb-1 p-1 border border-gray-600">
                <span>{{.Extension}}</span>
                <form method="POST" action="/projects/{{$.Project.ID}}/settings/extensions/{{.ID}}/delete" class="inline">
                    <button type="submit" class="text-red-400 hover:text-red-300 text-xs">Ã—</button>
                </form>
            </div>
            {{end}}
        </div>
        {{else}}
        <p class="text-xs text-gray-400">No excluded extensions configured.</p>
        {{end}}
    </div>

    <!-- Delete Project -->
    <div class="border-t border-gray-600 pt-4">
        <h4 class="text-red-400 mb-2">Danger Zone</h4>
        <p class="text-xs text-gray-400 mb-2">This action cannot be undone. All project data will be permanently deleted.</p>
        <form method="POST" action="/projects/{{.Project.ID}}/settings/delete" onsubmit="return confirm('Are you sure you want to delete this project? This action cannot be undone.')">
            <button type="submit" class="btn" style="background: #dc2626; color: white;">Delete Project</button>
        </form>
    </div>
</div>

{{template "footer" .}}
{{end}} 